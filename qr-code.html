<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro QR Code Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: #f1f5f9;
            color: #0f172a;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 1);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        #qrcode canvas, #qrcode img {
            margin: 0 auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            max-width: 100%;
            height: auto !important;
        }

        /* Transparency Checkerboard Pattern */
        .checkerboard {
            background-image: linear-gradient(45deg, #e2e8f0 25%, transparent 25%), 
                              linear-gradient(-45deg, #e2e8f0 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #e2e8f0 75%), 
                              linear-gradient(-45deg, transparent 75%, #e2e8f0 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .gradient-btn {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            transition: all 0.2s ease;
        }

        .gradient-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            opacity: 1;
        }

        .toggle-checkbox:checked {
            right: 0;
            border-color: #0f172a;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #0f172a;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

    <div class="max-w-5xl w-full grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
        
        <!-- Sidebar / Settings -->
        <div class="lg:col-span-5 space-y-6">
            <div class="glass-card p-8 rounded-[2rem]">
                <h1 class="text-3xl font-extrabold mb-2 tracking-tight text-slate-900">QR Studio</h1>
                <p class="text-slate-500 mb-8 text-sm">Create high-resolution QR codes for print and digital use.</p>

                <div class="space-y-5">
                    <!-- Content Input -->
                    <div>
                        <label class="block text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Content / URL</label>
                        <textarea 
                            id="text-input" 
                            class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-slate-900 focus:border-slate-900 transition-all outline-none resize-none text-sm font-medium"
                            rows="3"
                            placeholder="Enter URL or text..."
                        >https://google.com</textarea>
                    </div>

                    <!-- Appearance -->
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Code Color</label>
                                <div class="flex items-center gap-2 p-2 bg-slate-50 border border-slate-200 rounded-xl">
                                    <input type="color" id="fg-color" value="#000000" class="w-8 h-8 rounded-lg cursor-pointer bg-transparent border-none">
                                    <span class="text-xs font-mono uppercase" id="fg-hex">#000000</span>
                                </div>
                            </div>
                            <div id="bg-color-container">
                                <label class="block text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Background</label>
                                <div class="flex items-center gap-2 p-2 bg-slate-50 border border-slate-200 rounded-xl transition-opacity" id="bg-picker-wrapper">
                                    <input type="color" id="bg-color" value="#ffffff" class="w-8 h-8 rounded-lg cursor-pointer bg-transparent border-none">
                                    <span class="text-xs font-mono uppercase" id="bg-hex">#FFFFFF</span>
                                </div>
                            </div>
                        </div>

                        <!-- Transparency Toggle -->
                        <div class="flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200">
                            <div>
                                <span class="text-sm font-bold text-slate-700">Transparent Background</span>
                                <p class="text-[10px] text-slate-400 uppercase tracking-tighter">Recommended for overlays</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="transparent-toggle" class="sr-only peer">
                                <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-slate-900"></div>
                            </label>
                        </div>
                    </div>

                    <!-- Export Resolution -->
                    <div>
                        <label class="block text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Export Resolution (Pixels)</label>
                        <div class="flex items-center gap-3">
                            <input 
                                type="number" 
                                id="export-size" 
                                value="1024" 
                                min="128" 
                                max="4096"
                                class="flex-1 p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-slate-900 outline-none text-sm font-semibold"
                            >
                            <div class="text-[10px] text-slate-400 leading-tight w-24">
                                Recommended:<br>
                                <b>2000px+</b> for Print
                            </div>
                        </div>
                    </div>

                    <div class="pt-4">
                        <button 
                            id="download-btn"
                            class="w-full gradient-btn text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download High-Res PNG
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Area -->
        <div class="lg:col-span-7 flex flex-col items-center justify-center min-h-[400px]">
            <div id="preview-wrapper" class="glass-card p-12 rounded-[3rem] inline-block relative overflow-hidden transition-all duration-300">
                <div id="qrcode-bg-layer" class="absolute inset-0 transition-colors duration-300"></div>
                <div id="qrcode" class="relative z-10 flex justify-center items-center p-2 rounded-xl"></div>
                
                <div id="status-msg" class="absolute -bottom-10 left-0 right-0 text-center text-xs font-bold uppercase tracking-[0.2em] text-slate-400">
                    Live Preview
                </div>
            </div>
            
            <div class="mt-16 flex flex-wrap justify-center gap-6 text-slate-400">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-emerald-400"></div>
                    <span class="text-xs font-medium">Auto-generating</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-blue-400"></div>
                    <span class="text-xs font-medium">Print-Ready (300DPI)</span>
                </div>
                <button id="toggle-checkerboard" class="flex items-center gap-2 hover:text-slate-600 transition-colors">
                    <div class="w-4 h-4 rounded border border-slate-300 checkerboard"></div>
                    <span class="text-xs font-bold uppercase tracking-tighter">Toggle Transparency Grid</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Hidden container for high-res rendering -->
    <div id="hidden-renderer" style="position: absolute; left: -9999px; top: -9999px;"></div>

    <script>
        const textInput = document.getElementById('text-input');
        const qrcodeDiv = document.getElementById('qrcode');
        const qrcodeBgLayer = document.getElementById('qrcode-bg-layer');
        const fgColor = document.getElementById('fg-color');
        const bgColor = document.getElementById('bg-color');
        const fgHex = document.getElementById('fg-hex');
        const bgHex = document.getElementById('bg-hex');
        const bgPickerWrapper = document.getElementById('bg-picker-wrapper');
        const transToggle = document.getElementById('transparent-toggle');
        const checkerboardBtn = document.getElementById('toggle-checkerboard');
        const previewWrapper = document.getElementById('preview-wrapper');
        
        const exportSizeInput = document.getElementById('export-size');
        const downloadBtn = document.getElementById('download-btn');
        const statusMsg = document.getElementById('status-msg');
        const hiddenRenderer = document.getElementById('hidden-renderer');

        let isCheckerboardActive = false;

        function generatePreview() {
            const content = textInput.value.trim();
            qrcodeDiv.innerHTML = "";
            
            // Sync labels and transparency UI
            fgHex.innerText = fgColor.value.toUpperCase();
            bgHex.innerText = bgColor.value.toUpperCase();

            const isTransparent = transToggle.checked;
            const finalBgColor = isTransparent ? 'transparent' : bgColor.value;

            // Update UI State
            bgPickerWrapper.style.opacity = isTransparent ? '0.3' : '1';
            bgPickerWrapper.style.pointerEvents = isTransparent ? 'none' : 'auto';
            
            // Update Preview Background
            if (!isCheckerboardActive) {
                qrcodeBgLayer.style.backgroundColor = isTransparent ? 'transparent' : bgColor.value;
                qrcodeBgLayer.classList.remove('checkerboard');
            } else {
                qrcodeBgLayer.style.backgroundColor = 'transparent';
                qrcodeBgLayer.classList.add('checkerboard');
            }

            if (!content) {
                statusMsg.innerText = "Waiting for content...";
                return;
            }

            statusMsg.innerText = "Live Preview";

            // Preview QR
            new QRCode(qrcodeDiv, {
                text: content,
                width: 256,
                height: 256,
                colorDark: fgColor.value,
                colorLight: finalBgColor,
                correctLevel: QRCode.CorrectLevel.H
            });
        }

        async function triggerHighResDownload() {
            const content = textInput.value.trim();
            const size = parseInt(exportSizeInput.value) || 1024;
            const isTransparent = transToggle.checked;
            const finalBgColor = isTransparent ? 'transparent' : bgColor.value;
            
            if (!content) return;

            // Show loading state
            const originalBtnText = downloadBtn.innerHTML;
            downloadBtn.disabled = true;
            downloadBtn.innerHTML = `
                <svg class="animate-spin h-5 w-5 mr-3 text-white" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Rendering High-Res...
            `;

            hiddenRenderer.innerHTML = "";

            const hiResQR = new QRCode(hiddenRenderer, {
                text: content,
                width: size,
                height: size,
                colorDark: fgColor.value,
                colorLight: finalBgColor,
                correctLevel: QRCode.CorrectLevel.H
            });

            setTimeout(() => {
                const canvas = hiddenRenderer.querySelector('canvas');
                const img = hiddenRenderer.querySelector('img');
                
                let dataUrl;
                if (img && img.src && img.src.startsWith('data:image')) {
                    dataUrl = img.src;
                } else if (canvas) {
                    dataUrl = canvas.toDataURL("image/png");
                }

                if (dataUrl) {
                    const link = document.createElement('a');
                    link.href = dataUrl;
                    link.download = `QR_Studio_${isTransparent ? 'Trans_' : ''}${size}px.png`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showMessage("PNG Exported Successfully", "success");
                } else {
                    showMessage("Render error", "error");
                }

                downloadBtn.disabled = false;
                downloadBtn.innerHTML = originalBtnText;
            }, 600);
        }

        function showMessage(text, type) {
            statusMsg.innerText = text;
            statusMsg.className = `absolute -bottom-10 left-0 right-0 text-center text-xs font-bold uppercase tracking-[0.2em] ${type === 'error' ? 'text-rose-500' : 'text-emerald-500'}`;
            setTimeout(() => {
                statusMsg.innerText = "Live Preview";
                statusMsg.className = "absolute -bottom-10 left-0 right-0 text-center text-xs font-bold uppercase tracking-[0.2em] text-slate-400";
            }, 3000);
        }

        // Event Listeners
        textInput.addEventListener('input', generatePreview);
        fgColor.addEventListener('input', generatePreview);
        bgColor.addEventListener('input', generatePreview);
        transToggle.addEventListener('change', generatePreview);
        
        checkerboardBtn.addEventListener('click', () => {
            isCheckerboardActive = !isCheckerboardActive;
            generatePreview();
        });

        downloadBtn.addEventListener('click', triggerHighResDownload);

        exportSizeInput.addEventListener('change', () => {
            if (exportSizeInput.value > 4096) exportSizeInput.value = 4096;
            if (exportSizeInput.value < 128) exportSizeInput.value = 128;
        });

        // Initialize
        window.onload = generatePreview;
    </script>
</body>
</html>
